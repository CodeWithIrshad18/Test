ID	SeqNo	ModuleID	CreatedOn	CreatedBy	Attachments	IsActive
01EFC6EA-FED2-40E0-BD3E-11418AB3E9A6	7	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	2026-01-06 11:13:49.000	159445	1064087b-9d64-48f0-9c91-15d075084a21Screenshot 2025-12-18 095419.png	1
1064087B-9D64-48F0-9C91-15D075084A21	6	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	2026-01-06 11:13:14.000	159445	1064087b-9d64-48f0-9c91-15d075084a21Slide14 1.PNG	1
CB1A0511-944B-4953-AB57-4BAB0013EB07	3	8974E29B-269D-4707-BB44-39CA88285D37	2026-01-06 11:09:47.000	159445	cb1a0511-944b-4953-ab57-4bab0013eb07Screenshot 2025-12-17 182925.png	1
94B74322-DE7B-458F-9300-7666A16FFF5B	8	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	2026-01-06 11:14:01.000	159445	1064087b-9d64-48f0-9c91-15d075084a21Screenshot 2025-12-18 095343.png	1
E29237C4-4D00-46D5-AD11-9C9B591462A4	1	12ED0FE6-D3D3-4A13-BCCB-6E7272FDADF7	2026-01-06 11:07:49.000	159445	e29237c4-4d00-46d5-ad11-9c9b591462a4Screenshot 2025-12-17 170622 1.png	1
8050B57A-1289-4FFA-84DC-A79D0EBA16FE	9	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	2026-01-06 11:14:16.000	159445	1064087b-9d64-48f0-9c91-15d075084a21Screenshot 2025-12-18 095646.png	1
046326A2-F950-4F7A-860A-EE8DDD73B011	2	041AC05D-822D-4597-9F89-C0389A56AD13	2026-01-06 11:08:29.000	159445	046326a2-f950-4f7a-860a-ee8ddd73b011Screenshot 2025-12-17 181535.png	1



Id	ModuleID	QuestionType	Question	Option1	Option2	Option3	Option4	Ans	QuestionImage	IsActive	CreatedOn	UpdatedOn	CreatedBy	UpdatedBy	SeqNo
57FF2291-5528-40F8-92CB-060575E54ACF	041AC05D-822D-4597-9F89-C0389A56AD13	Objective	Which component is the lightweight, cross-platform web server included by default in ASP.NET Core applications? 	IIS	Apache	Kestrel	Nginx	1	NULL	1	2026-01-06 11:20:10.000	NULL	159445	NULL	2
187D3FEA-9F26-4688-AF8D-1A200599BAF0	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Objective	Which of the following is NOT a feature of ASP.NET?	Web Forms	MVC	Routing	React.js	4	NULL	1	2026-01-06 11:57:23.000	NULL	159445	NULL	1
EBB81265-CE4B-44BA-8D88-4C5E94EA8837	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Objective	ASP.NET applications can be hosted on which of the following?	Windows Server	Linux	MacOS	All of the above	1	NULL	1	2026-01-06 12:00:44.000	NULL	159445	NULL	3
F8366C72-6EEE-45A5-8290-59436F6DF2B8	8974E29B-269D-4707-BB44-39CA88285D37	Objective	Which language is primarily used for ASP.NET web application development?	Java	C#	Python	Ruby	2	NULL	1	2026-01-06 11:25:58.000	NULL	159445	NULL	1
C7124DD4-AAEE-4348-9F9B-93DD4B202E97	12ED0FE6-D3D3-4A13-BCCB-6E7272FDADF7	Subjective	What is .NET Core? why we prefer .NET Core in place of .NET?					1	NULL	1	2026-01-06 11:17:24.000	NULL	159445	NULL	1
403712E7-C646-480E-B3B3-C8D1565971A1	FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Objective	What does the 'ASP' in ASP.NET stand for?	Active Server Pages	Application Service Pages	Active Service Pages	Application Server Pages	1	NULL	1	2026-01-06 11:59:23.000	NULL	159445	NULL	2





ModuleId	ModuleName	ModuleImage	QuestionId	QuestionType	Question	Option1	Option2	Option3	Option4	QuestionImage	SeqNo
12ED0FE6-D3D3-4A13-BCCB-6E7272FDADF7	Home Page	e29237c4-4d00-46d5-ad11-9c9b591462a4Screenshot 2025-12-17 170622 1.png	C7124DD4-AAEE-4348-9F9B-93DD4B202E97	Subjective	What is .NET Core? why we prefer .NET Core in place of .NET?					NULL	1
041AC05D-822D-4597-9F89-C0389A56AD13	CHRO Message	NULL	57FF2291-5528-40F8-92CB-060575E54ACF	Objective	Which component is the lightweight, cross-platform web server included by default in ASP.NET Core applications? 	IIS	Apache	Kestrel	Nginx	NULL	2
8974E29B-269D-4707-BB44-39CA88285D37	Instructions	NULL	F8366C72-6EEE-45A5-8290-59436F6DF2B8	Objective	Which language is primarily used for ASP.NET web application development?	Java	C#	Python	Ruby	NULL	1
45F01FDE-0D73-46E1-8D34-9976B3C4E1DE	Milestone4	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Milestone1	NULL	187D3FEA-9F26-4688-AF8D-1A200599BAF0	Objective	Which of the following is NOT a feature of ASP.NET?	Web Forms	MVC	Routing	React.js	NULL	1
FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Milestone1	NULL	403712E7-C646-480E-B3B3-C8D1565971A1	Objective	What does the 'ASP' in ASP.NET stand for?	Active Server Pages	Application Service Pages	Active Service Pages	Application Server Pages	NULL	2
FCB7ADB8-E802-4957-9410-C3B4B354CDDA	Milestone1	NULL	EBB81265-CE4B-44BA-8D88-4C5E94EA8837	Objective	ASP.NET applications can be hosted on which of the following?	Windows Server	Linux	MacOS	All of the above	NULL	3



<div class="container mt-4">

    <div id="quizCarousel" class="carousel slide" data-bs-interval="false">
        <div class="carousel-inner">

            <asp:Repeater ID="rptSlides"
                runat="server"
                OnItemDataBound="rptSlides_ItemDataBound">

                <ItemTemplate>

                    <div class='carousel-item <%# Container.ItemIndex == 0 ? "active" : "" %>'>

                        <!-- ================= MODULE SLIDE ================= -->
                        <asp:Panel runat="server"
                            Visible='<%# Eval("SlideType").ToString() == "MODULE" %>'>

                            <div class="card text-center shadow p-4">

                                <asp:Image runat="server"
                                    ImageUrl='<%# string.IsNullOrEmpty(Eval("ModuleImage").ToString())
                                        ? ResolveUrl("~/Images/no-image.png")
                                        : ResolveUrl("~/Upload/" + Eval("ModuleImage")) %>'
                                    CssClass="img-fluid mb-3"
                                    Style="height:260px; object-fit:cover;" />

                                <h3><%# Eval("ModuleName") %></h3>

                                <p class="text-muted">
                                    <%# Eval("QuestionCount") %> Questions
                                </p>

                            </div>

                        </asp:Panel>

                        <!-- ================= QUESTION SLIDE ================= -->
                        <asp:Panel runat="server"
                            Visible='<%# Eval("SlideType").ToString() == "QUESTION" %>'>

                            <div class="card shadow p-4">

                                <h6 class="text-muted">
                                    <%# Eval("ModuleName") %>
                                </h6>

                                <h5 class="mb-3">
                                    <%# Eval("Question") %>
                                </h5>

                                <!-- Question Image -->
                                <asp:Image runat="server"
                                    ID="imgQuestion"
                                    CssClass="img-fluid mb-3"
                                    Visible="false" />

                                <!-- Objective -->
                                <asp:RadioButtonList
                                    ID="rblOptions"
                                    runat="server"
                                    CssClass="list-group"
                                    Visible="false">
                                </asp:RadioButtonList>

                                <!-- Subjective -->
                                <asp:TextBox
                                    ID="txtAnswer"
                                    runat="server"
                                    CssClass="form-control"
                                    TextMode="MultiLine"
                                    Rows="3"
                                    Visible="false" />

                            </div>

                        </asp:Panel>

                    </div>

                </ItemTemplate>
            </asp:Repeater>

        </div>

        <!-- Controls -->
        <button class="carousel-control-prev" type="button"
            data-bs-target="#quizCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>

        <button class="carousel-control-next" type="button"
            data-bs-target="#quizCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>

    </div>

</div>



 void LoadSlides()
 {

     string cs = ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString;

     DataTable dt = new DataTable();

     dt.Columns.Add("SlideType");
     dt.Columns.Add("ModuleId");
     dt.Columns.Add("ModuleName");
     dt.Columns.Add("ModuleImage");
     dt.Columns.Add("QuestionCount");
     dt.Columns.Add("Question");
     dt.Columns.Add("QuestionType");
     dt.Columns.Add("Option1");
     dt.Columns.Add("Option2");
     dt.Columns.Add("Option3");
     dt.Columns.Add("Option4");
     dt.Columns.Add("QuestionImage");

     string sql = @"
         SELECT 
             M.ID AS ModuleId,
             M.ModuleName,
             A.Attachments AS ModuleImage,
             Q.Id AS QuestionId,
             Q.QuestionType,
             Q.Question,
             Q.Option1,
             Q.Option2,
             Q.Option3,
             Q.Option4,
             Q.QuestionImage,
             Q.SeqNo
         FROM App_Module_Master M
         LEFT JOIN App_Module_Attachments A
             ON A.ModuleID = M.ID AND A.SeqNo = 1 AND A.IsActive = 1
         LEFT JOIN App_QuestionMaster Q
             ON Q.ModuleID = M.ID AND Q.IsActive = 1
         WHERE M.IsActive = 1
         ORDER BY M.SerialNo, Q.SeqNo";

     using (SqlConnection con = new SqlConnection(cs))
     using (SqlCommand cmd = new SqlCommand(sql, con))
     {
         con.Open();
         SqlDataReader dr = cmd.ExecuteReader();

         string lastModuleId = "";

         while (dr.Read())
         {
             string moduleId = dr["ModuleId"].ToString();

 
             if (lastModuleId != moduleId)
             {
                 DataRow m = dt.NewRow();
                 m["SlideType"] = "MODULE";
                 m["ModuleId"] = moduleId;
                 m["ModuleName"] = dr["ModuleName"];
                 m["ModuleImage"] = dr["ModuleImage"] == DBNull.Value ? "" : dr["ModuleImage"];
                 m["QuestionCount"] = GetQuestionCount(moduleId);
                 dt.Rows.Add(m);

                 lastModuleId = moduleId;
             }


             if (dr["QuestionId"] != DBNull.Value)
             {
                 DataRow q = dt.NewRow();
                 q["SlideType"] = "QUESTION";
                 q["ModuleId"] = moduleId;
                 q["ModuleName"] = dr["ModuleName"];
                 q["Question"] = dr["Question"];
                 q["QuestionType"] = dr["QuestionType"];
                 q["Option1"] = dr["Option1"];
                 q["Option2"] = dr["Option2"];
                 q["Option3"] = dr["Option3"];
                 q["Option4"] = dr["Option4"];
                 q["QuestionImage"] = dr["QuestionImage"];
                 dt.Rows.Add(q);
             }
         }
     }

     rptSlides.DataSource = dt;
     rptSlides.DataBind();
 }

 protected void rptSlides_ItemDataBound(object sender, RepeaterItemEventArgs e)
 {
     if (e.Item.ItemType != ListItemType.Item &&
         e.Item.ItemType != ListItemType.AlternatingItem)
         return;

     DataRowView row = (DataRowView)e.Item.DataItem;

     if (row["SlideType"].ToString() != "QUESTION")
         return;

  
     Image img = (Image)e.Item.FindControl("imgQuestion");
     if (row["QuestionImage"] != DBNull.Value)
     {
         img.ImageUrl = "~/Upload/" + row["QuestionImage"];
         img.Visible = true;
     }

     string qType = row["QuestionType"].ToString();


     if (qType == "Objective")
     {
         RadioButtonList rbl = (RadioButtonList)e.Item.FindControl("rblOptions");
         rbl.Visible = true;
         rbl.Items.Clear();

         rbl.Items.Add(new ListItem(row["Option1"].ToString(), "1"));
         rbl.Items.Add(new ListItem(row["Option2"].ToString(), "2"));
         rbl.Items.Add(new ListItem(row["Option3"].ToString(), "3"));
         rbl.Items.Add(new ListItem(row["Option4"].ToString(), "4"));
     }

     if (qType == "Subjective")
     {
         TextBox txt = (TextBox)e.Item.FindControl("txtAnswer");
         txt.Visible = true;
     }
 }

 int GetQuestionCount(string moduleId)
 {
     string cs = ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString;

     using (SqlConnection con = new SqlConnection(cs))
     using (SqlCommand cmd = new SqlCommand(
         "SELECT COUNT(*) FROM App_QuestionMaster WHERE ModuleID = @ModuleId AND IsActive = 1", con))
     {
         cmd.Parameters.AddWithValue("@ModuleId", moduleId);
         con.Open();
         return Convert.ToInt32(cmd.ExecuteScalar());
     }
 }
